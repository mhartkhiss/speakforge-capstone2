# 2.7 Manage Premium Subscription

## Front-end Components

- **ProfileFragment**: Profile screen with premium upgrade option
  - User type display: Shows current account type (free/premium)
  - Upgrade button: Initiates premium subscription process

- **UpgradeAccountActivity**: Dedicated upgrade screen
  - Upgrade button: Confirms subscription purchase
  - Cancel button: Returns to previous screen
  - Progress indicator: Shows processing status during upgrade

- **AlertDialog**: Success confirmation dialog
  - Title and message: Confirms successful upgrade
  - OK button: Dismisses dialog and returns to profile

## Back-end Components

- **FirebaseDatabase**: Updates user account type
  - users/{userId}/accountType reference: Account type storage
  - setValue("premium"): Updates user to premium status

- **UpgradeAccountActivity**: Business logic for subscription management
  - upgradeAccount(): Handles premium upgrade process
  - Account type update: Changes user status in database
  - Success feedback: Confirms upgrade completion to user

- **ProgressDialog**: Processing feedback during upgrade
  - Loading indicator: Shows "Processing payment..." message
  - Timed operation: Simulates payment processing delay

## Plant UML Diagrams

### Class Diagram (MVC Model)

```plantuml
@startuml Manage Premium Subscription Class Diagram

class "Model" as Model {
  - Classes: FirebaseDatabase.java
  - Methods: getReference(), setValue(), child(),
    addOnSuccessListener(), addOnFailureListener()
}

class "View" as View {
  - Classes: ProfileFragment.java, UpgradeAccountActivity.java,
    ProgressDialog.java, AlertDialog.java
  - Layouts: fragment_profile.xml, activity_upgrade_account.xml
  - Elements: userTypeView, upgrade_button, cancel_button
  - Methods: show(), dismiss(), setText(), setTitle(), setMessage()
}

class "Controller" as Controller {
  - Classes: UpgradeAccountActivity.java, ProfileFragment.java
  - Methods: upgradeAccount(), onCreate(), setOnClickListener(),
    openUpgradeActivity()
}

Model --> Controller : provides database
Controller --> View : updates UI
View --> Controller : user input

@enduml
```

### Sequence Diagram

```plantuml
@startuml Manage Premium Subscription Sequence Diagram

actor User
participant ProfileFragment
participant UpgradeAccountActivity
participant FirebaseDatabase

User -> ProfileFragment: Click upgrade to premium
ProfileFragment -> UpgradeAccountActivity: Navigate to upgrade screen
UpgradeAccountActivity -> UpgradeAccountActivity: Display upgrade UI
User -> UpgradeAccountActivity: Click upgrade button
UpgradeAccountActivity -> ProgressDialog: Show "Processing payment..."
UpgradeAccountActivity -> UpgradeAccountActivity: Simulate processing delay
UpgradeAccountActivity -> FirebaseDatabase: Update accountType to "premium"
FirebaseDatabase --> UpgradeAccountActivity: Update success
UpgradeAccountActivity -> ProgressDialog: Dismiss
UpgradeAccountActivity -> AlertDialog: Show success message
User -> AlertDialog: Click OK
UpgradeAccountActivity -> UpgradeAccountActivity: Finish activity

@enduml
```

### Data Design Diagram

```plantuml
@startuml Manage Premium Subscription Data Design Diagram

database "users/{userId}" as UserDB {
  userId : String <<PK>>
  accountType : String = "free"
  email : String
  username : String
  translator : String
}

class SubscriptionUpgrade {
  +currentAccountType : String
  +newAccountType : String = "premium"
  +processingTime : long = 3000
  +successMessage : String
}

SubscriptionUpgrade --> UserDB : updates accountType
UserDB --> ProfileFragment : reflects premium features

@enduml
```
