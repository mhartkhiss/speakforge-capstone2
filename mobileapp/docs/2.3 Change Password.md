# 2.3 Change Password

## Front-end Components

- **ProfileFragment**: Profile screen with password change option
  - Menu button for password change: Opens password modification form
  - Password change form: Shows when password menu is selected

- **ChangePassControl**: Controller managing password change operations
  - Old password EditText: Current password input field
  - New password EditText: New password input field
  - Confirm password EditText: Password confirmation field
  - Change password button: Triggers password update

- **UI Layout (fragment_profile.xml)**: Profile screen layout
  - Elements: btnMenuChangePassword, editTextOldPassword,
    editTextNewPassword, editTextConfirmPassword, btnChangePassword2

## Back-end Components

- **FirebaseAuth**: Firebase authentication service for password management
  - reauthenticate(): Verifies current password before change
  - updatePassword(): Changes user password in Firebase Auth
  - EmailAuthProvider.getCredential(): Creates auth credential for reauth

- **ChangePassControl**: Business logic for password change
  - validatePasswordFields(): Validates all password fields
  - changePassword(): Orchestrates password update process
  - Input validation: Checks empty fields and password matching

- **Security Measures**: Password change security
  - Reauthentication required: Must provide current password
  - Password confirmation: Ensures new password is entered correctly

## Plant UML Diagrams

### Class Diagram (MVC Model)

```plantuml
@startuml Change Password Class Diagram

class "Model" as Model {
  - Classes: FirebaseAuth.java, EmailAuthProvider.java
  - Methods: getCurrentUser(), reauthenticate(),
    updatePassword(), getCredential(), addOnSuccessListener(),
    addOnFailureListener()
}

class "View" as View {
  - Classes: ProfileFragment.java, ChangePassControl.java
  - Layouts: fragment_profile.xml
  - Elements: editTextOldPassword, editTextNewPassword,
    editTextConfirmPassword, btnChangePassword2, btnMenuChangePassword
  - Methods: setText(), getText(), showNotification()
}

class "Controller" as Controller {
  - Classes: ChangePassControl.java, ProfileFragment.java
  - Methods: onClick(), validatePasswordFields(),
    changePassword(), setListeners()
}

Model --> Controller : provides auth
Controller --> View : updates UI
View --> Controller : user input

@enduml
```

### Sequence Diagram

```plantuml
@startuml Change Password Sequence Diagram

actor User
participant ProfileFragment
participant ChangePassControl
participant FirebaseAuth

User -> ProfileFragment: Click change password menu
ProfileFragment -> ChangePassControl: Show password form
User -> ChangePassControl: Enter old, new, confirm passwords
User -> ChangePassControl: Click change password
ChangePassControl -> ChangePassControl: Validate fields
ChangePassControl -> FirebaseAuth: Reauthenticate with old password
FirebaseAuth --> ChangePassControl: Reauth success
ChangePassControl -> FirebaseAuth: Update to new password
FirebaseAuth --> ChangePassControl: Password update success
ChangePassControl -> ProfileFragment: Show success notification
ChangePassControl -> ChangePassControl: Clear password fields

@enduml
```

### Data Design Diagram

```plantuml
@startuml Change Password Data Design Diagram

database "Firebase Auth" as Auth {
  userId : String <<PK>>
  email : String
  passwordHash : String <<encrypted>>
  lastSignInAt : timestamp
}

class PasswordChange {
  +currentPassword : String
  +newPassword : String
  +confirmPassword : String
  +validation : boolean
}

class AuthCredential {
  +email : String
  +password : String
}

PasswordChange --> AuthCredential : creates
AuthCredential --> Auth : reauthenticates
PasswordChange --> Auth : updates password

@enduml
```
