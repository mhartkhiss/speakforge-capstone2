# 2.2 Change Preferred Language

## Front-end Components

- **ProfileFragment**: Main profile screen with language selection
  - Language display TextView: Shows current preferred language
  - Menu button for language change: Opens language selection

- **ChangeLanguageControl**: Controller managing language selection
  - BottomSheetDialog: Language selection modal
  - RecyclerView with LanguageAdapter: List of available languages
  - Language selection handling: Updates user preference

- **LanguageSetupActivity**: Dedicated activity for initial language setup
  - Dynamic button generation: Creates language selection buttons
  - Language selection buttons: Individual buttons for each language

## Back-end Components

- **FirebaseDatabase**: Stores user language preference
  - users/{userId}/language reference: Language setting storage
  - setValue(): Updates language in database
  - Real-time synchronization: Updates UI when language changes

- **Languages Model**: Language data management
  - getAllLanguages(): Returns list of supported languages
  - Language validation: Ensures selected language is valid

- **Variables Class**: Application-wide language storage
  - userLanguage: Stores current language setting
  - Language persistence: Maintains language across sessions

## Plant UML Diagrams

### Class Diagram (MVC Model)

```plantuml
@startuml Change Preferred Language Class Diagram

class "Model" as Model {
  - Classes: FirebaseDatabase.java, Languages.java, Variables.java
  - Methods: getReference(), setValue(), getAllLanguages(),
    userLanguage, addOnSuccessListener(), addOnFailureListener()
}

class "View" as View {
  - Classes: ProfileFragment.java, LanguageSetupActivity.java,
    BottomSheetDialog, LanguageAdapter.java
  - Layouts: fragment_profile.xml, activity_language_setup.xml
  - Elements: textViewLanguageValue, btnMenuChangeLanguage,
    recyclerViewLanguages, buttonContainer
  - Methods: show(), dismiss(), setText(), addView()
}

class "Controller" as Controller {
  - Classes: ChangeLanguageControl.java, LanguageSetupActivity.java
  - Methods: setupLanguageDialog(), updateLanguage(),
    updateSourceLanguage(), onCreate(), onBindViewHolder()
}

Model --> Controller : provides data
Controller --> View : updates UI
View --> Controller : user input

@enduml
```

### Sequence Diagram

```plantuml
@startuml Change Preferred Language Sequence Diagram

actor User
participant ProfileFragment
participant ChangeLanguageControl
participant FirebaseDatabase
participant Variables

User -> ProfileFragment: Click change language menu
ProfileFragment -> ChangeLanguageControl: Show language dialog
ChangeLanguageControl -> ProfileFragment: Display BottomSheetDialog
User -> ChangeLanguageControl: Select language
ChangeLanguageControl -> FirebaseDatabase: Update language
FirebaseDatabase --> ChangeLanguageControl: Update success
ChangeLanguageControl -> Variables: Set userLanguage
ChangeLanguageControl -> ProfileFragment: Show success notification
ChangeLanguageControl -> ProfileFragment: Dismiss dialog

@enduml
```

### Data Design Diagram

```plantuml
@startuml Change Preferred Language Data Design Diagram

database "users/{userId}" as UserDB {
  userId : String <<PK>>
  language : String
  translator : String
}

class Languages {
  +getAllLanguages(): List<String>
  +supportedLanguages : List<String>
}

class Variables {
  +userLanguage : String
  +userTranslator : String
}

class LanguageSelection {
  +selectedLanguage : String
  +validation : boolean
}

Languages --> LanguageSelection : provides options
LanguageSelection --> UserDB : updates language
LanguageSelection --> Variables : updates local

@enduml
```
