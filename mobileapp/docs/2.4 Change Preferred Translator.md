# 2.4 Change Preferred Translator

## Front-end Components

- **ProfileFragment**: Profile screen with translator selection
  - Translator display TextView: Shows current preferred translator
  - Menu button for translator change: Opens translator selection

- **ChangeTranslatorControl**: Controller managing translator selection
  - Dynamic translator buttons: Generated buttons for each translator type
  - Translator button layout: Custom button layout with icons and names
  - BottomSheetDialog: Modal for translator selection

- **TranslatorType Enum**: Defines available translator options
  - getDisplayName(): Returns user-friendly translator name
  - getIconResourceId(): Returns translator icon resource
  - getId(): Returns translator identifier

## Back-end Components

- **FirebaseDatabase**: Stores user translator preference
  - users/{userId}/translator reference: Translator setting storage
  - users/{userId}/accountType reference: Premium status checking
  - setValue(): Updates translator in database

- **ChangeTranslatorControl**: Business logic for translator management
  - setupTranslatorButtons(): Creates dynamic translator selection UI
  - checkPremiumAndUpdateTranslator(): Validates premium status before change
  - updateTranslator(): Saves new translator preference

- **Premium Validation**: Access control for translator features
  - Account type checking: Ensures user has premium subscription
  - Feature gating: Restricts advanced translators to premium users

## Plant UML Diagrams

### Class Diagram (MVC Model)

```plantuml
@startuml Change Preferred Translator Class Diagram

class "Model" as Model {
  - Classes: FirebaseDatabase.java, TranslatorType.java
  - Methods: getReference(), setValue(), getDisplayName(),
    getIconResourceId(), getId(), addOnSuccessListener(),
    addOnFailureListener()
}

class "View" as View {
  - Classes: ProfileFragment.java, BottomSheetDialog,
    MaterialButton.java
  - Layouts: fragment_profile.xml, translator_button.xml
  - Elements: textViewTranslatorValue, btnMenuSelectTranslator,
    translatorButtonsContainer
  - Methods: show(), dismiss(), setText(), addView(),
    setIcon(), setOnClickListener()
}

class "Controller" as Controller {
  - Classes: ChangeTranslatorControl.java, ProfileFragment.java
  - Methods: setupTranslatorButtons(), checkPremiumAndUpdateTranslator(),
    updateTranslator(), onCreateView()
}

Model --> Controller : provides data
Controller --> View : updates UI
View --> Controller : user input

@enduml
```

### Sequence Diagram

```plantuml
@startuml Change Preferred Translator Sequence Diagram

actor User
participant ProfileFragment
participant ChangeTranslatorControl
participant FirebaseDatabase

User -> ProfileFragment: Click change translator menu
ProfileFragment -> ChangeTranslatorControl: Show translator dialog
ChangeTranslatorControl -> ProfileFragment: Display BottomSheetDialog
User -> ChangeTranslatorControl: Select translator
ChangeTranslatorControl -> FirebaseDatabase: Check account type
FirebaseDatabase --> ChangeTranslatorControl: Return account type

alt Premium account
    ChangeTranslatorControl -> FirebaseDatabase: Update translator
    FirebaseDatabase --> ChangeTranslatorControl: Update success
    ChangeTranslatorControl -> ProfileFragment: Show success notification
else Free account
    ChangeTranslatorControl -> ProfileFragment: Show premium required notification
end

ChangeTranslatorControl -> ProfileFragment: Dismiss dialog

@enduml
```

### Data Design Diagram

```plantuml
@startuml Change Preferred Translator Data Design Diagram

database "users/{userId}" as UserDB {
  userId : String <<PK>>
  translator : String
  accountType : String
}

enum TranslatorType {
  +GEMINI
  +CLAUDE
  +DEEPSEEK
  +getDisplayName(): String
  +getIconResourceId(): int
  +getId(): String
}

class TranslatorSelection {
  +selectedTranslator : String
  +premiumRequired : boolean
  +validation : boolean
}

TranslatorType --> TranslatorSelection : provides options
TranslatorSelection --> UserDB : updates translator
UserDB.accountType --> TranslatorSelection : validates access

@enduml
```
