# 5.3 Usage Statistics

## Front-end Components

- **StatisticsCards**: Key metrics display component
  - Total users, active users, premium/free user counts
  - Trend indicators with color-coded arrows
  - Gradient card backgrounds with custom shadows
  - Responsive grid layout for different screen sizes

- **LoginTrendChart**: Login activity visualization
  - Line and bar chart toggle functionality
  - Time period selectors (7 days, 1 month, 3 months, etc.)
  - Interactive chart with hover tooltips
  - Chart.js integration with custom styling

- **AccountTypeChart**: User distribution pie chart
  - Premium vs Free account type visualization
  - Percentage breakdowns with color coding
  - Interactive legend and tooltips
  - Doughnut chart style with center text

- **LanguageDistributionChart**: Language usage analytics
  - Horizontal bar chart of user language preferences
  - Percentage calculations and display
  - Color-coded bars for different languages
  - Responsive chart scaling

- **StatisticsControlBar**: Analytics controls and filters
  - Time period selection dropdown
  - Refresh data functionality
  - Loading state indicators
  - Period label updates based on selection

## Back-end Components

- **Usage Statistics API**: Analytics data endpoints
  - GET /admin/statistics/users/ - User metrics and trends
  - GET /admin/statistics/logins/ - Login activity data
  - GET /admin/statistics/languages/ - Language distribution
  - GET /admin/statistics/accounts/ - Account type breakdowns

- **Firebase Analytics Integration**: Real-time data aggregation
  - User registration tracking across time periods
  - Login event logging and timestamp recording
  - Account type changes and user status updates
  - Language preference data collection

- **Time-based Data Processing**: Period filtering and aggregation
  - Date range calculations for different periods
  - Data aggregation by day/week/month
  - Trend calculation algorithms (percentage changes)
  - Cache management for performance optimization

- **Chart Data Formatting**: Visualization data preparation
  - Chart.js compatible data structure creation
  - Label generation and formatting
  - Color scheme application
  - Tooltip and legend data preparation

## Plant UML Diagrams

### Class Diagram (MVC Model)

```plantuml
@startuml Usage Statistics Class Diagram

class "Model" as Model {
  - Classes: Statistics API, Firebase Analytics,
    Chart Data Processor
  - Methods: fetchUserStats(), fetchLoginTrends(),
    fetchLanguageStats(), calculateTrends(),
    aggregateData()
}

class "View" as View {
  - Classes: StatisticsCards, LoginTrendChart,
    AccountTypeChart, LanguageDistributionChart,
    StatisticsControlBar, Chart.js
  - Layouts: StatisticsCards.jsx, LoginTrendChart.jsx,
    AccountTypeChart.jsx
  - Elements: statsCards, trendChart, pieChart,
    barChart, periodSelector, refreshButton
  - Methods: render(), updateChart(), setChartType(),
    handlePeriodChange()
}

class "Controller" as Controller {
  - Classes: AdminDashboard statistics logic
  - Methods: loadStatistics(), handlePeriodChange(),
    refreshData(), processChartData(),
    updateTrends()
}

Model --> Controller : provides analytics data
Controller --> View : updates charts and metrics
View --> Controller : user interactions

@enduml
```

### Sequence Diagram

```plantuml
@startuml Usage Statistics Sequence Diagram

actor Admin
participant AdminDashboard
participant StatisticsAPI
participant StatisticsCards
participant LoginTrendChart

Admin -> AdminDashboard: Access statistics tab
AdminDashboard -> StatisticsAPI: GET /admin/statistics/users/
StatisticsAPI --> AdminDashboard: Return user metrics
AdminDashboard -> StatisticsCards: Set user statistics
StatisticsCards -> StatisticsCards: Render metric cards

AdminDashboard -> StatisticsAPI: GET /admin/statistics/logins/
StatisticsAPI --> AdminDashboard: Return login trends
AdminDashboard -> LoginTrendChart: Set chart data
LoginTrendChart -> LoginTrendChart: Render trend chart

Admin -> StatisticsControlBar: Change time period
StatisticsControlBar -> AdminDashboard: onPeriodChange()
AdminDashboard -> StatisticsAPI: GET /admin/statistics/users/?period=1m
StatisticsAPI --> AdminDashboard: Return filtered data
AdminDashboard -> StatisticsCards: Update with new data
AdminDashboard -> LoginTrendChart: Update chart data

@enduml
```

### Data Design Diagram

```plantuml
@startuml Usage Statistics Data Design Diagram

database "Firebase Analytics" as FirebaseAnalytics {
  user_events : UserEvent
  login_events : LoginEvent
}

class UserStatistics {
  +totalUsers : number
  +activeUsersLast7Days : number
  +premiumUsers : number
  +freeUsers : number
  +languageDistribution : Map<String, number>
  +trends : Map<String, String>
}

class LoginTrendData {
  +period : String <<7d/1m/3m/6m/1y>>
  +dailyLoginUsage : List<DailyLogin>
  +chartType : String <<line/bar>>
}

class DailyLogin {
  +date : String
  +count : number
  +uniqueUsers : number
}

class ChartData {
  +labels : String[]
  +datasets : ChartDataset[]
  +options : ChartOptions
}

UserStatistics --> LoginTrendData : includes trend data
DailyLogin --> ChartData : converted for visualization
FirebaseAnalytics --> UserStatistics : aggregates data

@enduml
```
